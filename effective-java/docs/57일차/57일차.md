# 57일차 2024-06-17 p.351 ~

## 아이템 59. 라이브러리를 익히고 사용하라

무작위 정수 하나를 생성하고 싶다고 해보자. 같의 범위는 0부터 명시한 수 이다.
아주 흔히 마주치는 문제로, 많은 프로그래머가 다음과 같은 짤막한 메서드를 만들곤 한다.

`코드 59-1 흔하지만 문제가 심각한 코드`

```java
import java.util.Random;

static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) % n;
}

```

괜찮은 듯 보여도 문제를 세 가지나 내포하고 있다. 
첫 번째 n이 그리 크지 않은 2의 제곱수라면 얼마 지나지 않아 같은 수열이 반복된다.

두 번째, n이 2의 제곲후가 아니라면 몇몇 숫자가 평균적으로 더 자주 반환된다. 
n값이 크면 이 현상은 더 두드러진다. 

다음 코드는 예시를 위해 필자가 신중히 선택한 범위에서 무작위 수를 백만개를 생성한 다음,
그중 중간 값보다 작은 게 몇 개인지를 출력한다.

```java
public static void main(String[] args) {
    int n = 2 * (Integer.MAX_VALUE / 3);
    int low = 0;
    for (int i = 0; i < 1000000; i++) {
        if (random(n) < n/2)
            low++;
    }
    System.out.println(low);

```

random 메서드가 이상적으로 동작한다면 약 50만 개가 출력돼야 하지만,
실제로 돌려보면 666,666 에 가까운 값을 얻는다. 
무작위로 생성된 수 중에서 2/3 가량이 중간값보다 낮은 쪽으로 쏠린 것이다.

자바 7부터는 Random 을 더 이상 사용하지 않는게 좋다.
ThreadLocalRandom 으로 대체하면 대부분 잘 동작한다. 

Random 보다 더 고품질의 무작위 수를 생성할 뿐만 아니라 속도도 더 빠르다.


이상의 이점들에 비춰볼 때 표준 라이브러리의 기능을 사용하는 것이 좋아 보이지만, 
실상은 많은 프로그래머가 직접 구현해 쓰고 있다.

왜 그럴까? 아마도 라이브러리에 그런 기능이 있는지 모르기 때문 일 것이다.
**메이저 릴리스마다 주목할 만한 수많은 기능이 라이브러리에 추가 된다.**
자바는 메이저 릴리스마다 새로운 기능을 설명하는 웹페이지를 공시하는데, 
한 번쯤 읽어볼 만하다.


> **핵심 정리**
> <br/>
> 바퀴를 다시 발명하지 말자. 아주 특별한 나만의 기능이 아니라면 누군가 이미 라이브러리 형태로
> 구현해놓았을 가능성이 크다. 그런 라이브러리가 있다면 , 쓰면 된다. 
> 있는지 잘 모르겠다면 찾아보라. 일반적으로 라이브러리의 코드는 여러분이 직접 작성한 것보다
> 품질이 좋고, 점차 개선될 가능성이 크다. 여러분의 실력을 폄하하는 게 아니다.
> 코드 품질에도 규모의 경제가 적용된다. 즉, 라이브러리 코드는 개발자 각자가 작성하는 것보다 
> 주목을 훨씬 많이 받으므로 코드 품질도 그만큼 높아진다.

